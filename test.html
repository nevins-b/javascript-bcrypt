<html>
<meta http-equiv="Content-Type" content="text/html;charset=windows-1252" >
<head>
<script src="MochiKit/MochiKit.js" type="text/javascript"></script>
<script src="Clipperz/Base.js" type="text/javascript"></script>
<script src="Clipperz/ByteArray.js" type="text/javascript"></script>
<script src="Clipperz/Crypto/BigInt.js" type="text/javascript"></script>
<script src="Clipperz/Crypto/SHA.js" type="text/javascript"></script>
<script src="Clipperz/Crypto/AES.js" type="text/javascript"></script>
<script src="Clipperz/Crypto/PRNG.js" type="text/javascript"></script>

<script src="bCrypt.js" type="text/javascript"></script>
<script type="text/javascript">
var bcrypt = new bCrypt();
function crypt(form){
	var salt;
	if(form.salt.value){
		salt = form.salt.value;
	}else{
		try{
			salt = bcrypt.gensalt(form.rounds.value);
		}catch(err){
			alert(err);
			return
		}
		form.salt.value = salt;
	}
	try{
		var hash = bcrypt.hashpw(form.password.value, salt);
	}catch(err){
		alert(err);
		return;
	}
	alert(hash);
}
</script>
</head>
<body>
<form >
<label for="password">Password: </label><input type="text" name="password" id="password"></input>
<br />
<label for="salt">Salt (Optional): </label><input type="text" name="salt" id="salt"></input>
<br />
<label for="rounds">Rounds: </label>
<select id="rounds" name="rounds">
  <option value=5>5</option>
  <option value=6>6</option>
  <option value=7>7</option>
  <option value=8>8</option>
  <option value=9>9</option>
  <option value=10>10</option>
  <option value=11>11</option>
  <option value=12>12</option>
</select>
<br />
<INPUT TYPE="button" NAME="button" Value="Generate Hash" onClick="crypt(this.form)">
</form>
</body>
</html>